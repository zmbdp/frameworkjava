<!DOCTYPE HTML>
<html lang="zh">
<head>
    <!-- Generated by javadoc (17) on Sat Jan 31 16:37:34 CST 2026 -->
    <title>LogAnnotationMergeStrategy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="dc.created" content="2026-01-31">
    <meta name="description"
          content="declaration: package: com.zmbdp.common.log.strategy.impl, class: LogAnnotationMergeStrategy">
    <meta name="generator" content="javadoc/ClassWriterImpl">
    <link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
    <link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
    <link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
    <script type="text/javascript" src="../../../../../../script.js"></script>
    <script type="text/javascript" src="../../../../../../script-dir/jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
    <div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<div class="flex-box">
    <header role="banner" class="flex-header">
        <nav role="navigation">
            <!-- ========= START OF TOP NAVBAR ======= -->
            <div class="top-nav" id="navbar-top">
                <div class="skip-nav"><a href="#skip-navbar-top" title="跳过导航链接">跳过导航链接</a></div>
                <ul id="navbar-top-firstrow" class="nav-list" title="导航">
                    <li><a href="../../../../../../index.html">概览</a></li>
                    <li><a href="package-summary.html">程序包</a></li>
                    <li class="nav-bar-cell1-rev">类</li>
                    <li><a href="package-tree.html">树</a></li>
                    <li><a href="../../../../../../deprecated-list.html">已过时</a></li>
                    <li><a href="../../../../../../index-files/index-1.html">索引</a></li>
                    <li><a href="../../../../../../help-doc.html#class">帮助</a></li>
                </ul>
            </div>
            <div class="sub-nav">
                <div>
                    <ul class="sub-nav-list">
                        <li>概要:&nbsp;</li>
                        <li>嵌套&nbsp;|&nbsp;</li>
                        <li><a href="#field-summary">字段</a>&nbsp;|&nbsp;</li>
                        <li><a href="#constructor-summary">构造器</a>&nbsp;|&nbsp;</li>
                        <li><a href="#method-summary">方法</a></li>
                    </ul>
                    <ul class="sub-nav-list">
                        <li>详细资料:&nbsp;</li>
                        <li><a href="#field-detail">字段</a>&nbsp;|&nbsp;</li>
                        <li><a href="#constructor-detail">构造器</a>&nbsp;|&nbsp;</li>
                        <li><a href="#method-detail">方法</a></li>
                    </ul>
                </div>
                <div class="nav-list-search"><label for="search-input">SEARCH:</label>
                    <input type="text" id="search-input" value="search" disabled="disabled">
                    <input type="reset" id="reset-button" value="reset" disabled="disabled">
                </div>
            </div>
            <!-- ========= END OF TOP NAVBAR ========= -->
            <span class="skip-nav" id="skip-navbar-top"></span></nav>
    </header>
    <div class="flex-content">
        <main role="main">
            <!-- ======== START OF CLASS DATA ======== -->
            <div class="header">
                <div class="sub-title"><span class="package-label-in-type">程序包</span>&nbsp;<a
                        href="package-summary.html">com.zmbdp.common.log.strategy.impl</a></div>
                <h1 title="类 LogAnnotationMergeStrategy" class="title">类 LogAnnotationMergeStrategy</h1>
            </div>
            <div class="inheritance" title="继承树"><a
                    href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html"
                    title="java.lang中的类或接口" class="external-link">java.lang.Object</a>
                <div class="inheritance">com.zmbdp.common.log.strategy.impl.LogAnnotationMergeStrategy</div>
            </div>
            <section class="class-description" id="class-description">
                <dl class="notes">
                    <dt>所有已实现的接口:</dt>
                    <dd><code><a href="../ILogProcessStrategy.html" title="com.zmbdp.common.log.strategy中的接口">ILogProcessStrategy</a></code>
                    </dd>
                </dl>
                <hr>
                <div class="type-signature"><span class="annotations">@Component
</span><span class="modifiers">public class </span><span
                        class="element-name type-name-label">LogAnnotationMergeStrategy</span>
                    <span class="extends-implements">extends <a
                            href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html"
                            title="java.lang中的类或接口" class="external-link">Object</a>
implements <a href="../ILogProcessStrategy.html"
              title="com.zmbdp.common.log.strategy中的接口">ILogProcessStrategy</a></span></div>
                <div class="block">日志注解合并策略
                    <p>
                        实现 <a href="../ILogProcessStrategy.html" title="com.zmbdp.common.log.strategy中的接口"><code>ILogProcessStrategy</code></a>
                        接口，提供日志注解的合并功能。<br>
                        合并方法注解、类注解和 Nacos 全局配置，优先级：方法注解 > 类注解 > 全局默认。
                    <p>
                        <b>核心功能：</b>
                    <ul>
                        <li>注解合并：合并方法注解、类注解和全局配置</li>
                        <li>优先级控制：方法注解 > 类注解 > Nacos 全局配置 > 默认值</li>
                        <li>动态配置支持：支持从 Nacos 读取全局默认配置</li>
                        <li>代理模式实现：返回动态代理对象，按需计算配置值</li>
                    </ul>
                    <p>
                        <b>使用示例：</b>
                    <pre><code>
 @Autowired
 private LogAnnotationMergeStrategy annotationMergeStrategy;

 // 合并方法注解和类注解
 LogAction mergedAction = annotationMergeStrategy.merge(methodLogAction, classLogAction);

 // 获取合并后的配置
 boolean recordParams = mergedAction.recordParams();
 boolean recordResult = mergedAction.recordResult();
 </code></pre>
                    <p>
                        <b>合并规则：</b>
                    <ul>
                        <li><b>value</b>：使用方法注解的值（必填）</li>
                        <li><b>recordParams</b>：方法注解 true → true，否则类注解 true → true，否则全局配置</li>
                        <li><b>recordResult</b>：方法注解 true → true，否则类注解 true → true，否则全局配置</li>
                        <li><b>recordException</b>：方法注解 false → false，否则类注解 false → false，否则全局配置</li>
                        <li><b>throwException</b>：方法注解 false → false，否则类注解 false → false，否则全局配置</li>
                        <li><b>condition</b>：方法注解非空 → 方法注解，否则类注解</li>
                        <li><b>paramsExpression</b>：方法注解非空 → 方法注解，否则类注解</li>
                        <li><b>resultExpression</b>：方法注解非空 → 方法注解，否则类注解</li>
                        <li><b>module</b>：方法注解非空 → 方法注解，否则类注解</li>
                        <li><b>businessType</b>：方法注解非空 → 方法注解，否则类注解</li>
                        <li><b>desensitizeFields</b>：方法注解非空 → 方法注解，否则类注解</li>
                        <li><b>storageType</b>：方法注解非空 → 方法注解，否则类注解</li>
                    </ul>
                    <p>
                        <b>Nacos 全局配置：</b>
                    <ul>
                        <li>log.default.record-params：全局默认是否记录参数（默认 false）</li>
                        <li>log.default.record-result：全局默认是否记录返回值（默认 false）</li>
                        <li>log.default.record-exception：全局默认是否记录异常（默认 true）</li>
                        <li>log.default.throw-exception：全局默认是否抛出异常（默认 true）</li>
                    </ul>
                    <p>
                        <b>注意事项：</b>
                    <ul>
                        <li>方法注解不能为 null，类注解可以为 null</li>
                        <li>返回的是动态代理对象，不是真实的注解对象</li>
                        <li>配置值按需计算，支持动态更新</li>
                        <li>所有异常都会被捕获，不会影响日志记录流程</li>
                    </ul>
                </div>
                <dl class="notes">
                    <dt>作者:</dt>
                    <dd>稚名不带撇</dd>
                    <dt>另请参阅:</dt>
                    <dd>
                        <ul class="see-list">
                            <li><a href="../ILogProcessStrategy.html"
                                   title="com.zmbdp.common.log.strategy中的接口"><code>ILogProcessStrategy</code></a>
                            </li>
                            <li><a href="../../annotation/LogAction.html"
                                   title="annotation interface in com.zmbdp.common.log.annotation"><code>LogAction</code></a>
                            </li>
                            <li><a href="../../../domain/constants/LogConstants.html"
                                   title="com.zmbdp.common.domain.constants中的类"><code>LogConstants</code></a></li>
                        </ul>
                    </dd>
                </dl>
            </section>
            <section class="summary">
                <ul class="summary-list">
                    <!-- =========== FIELD SUMMARY =========== -->
                    <li>
                        <section class="field-summary" id="field-summary">
                            <h2>字段概要</h2>
                            <div class="caption"><span>字段</span></div>
                            <div class="summary-table three-column-summary">
                                <div class="table-header col-first">修饰符和类型</div>
                                <div class="table-header col-second">字段</div>
                                <div class="table-header col-last">说明</div>
                                <div class="col-first even-row-color"><code>private
                                    org.springframework.core.env.Environment</code></div>
                                <div class="col-second even-row-color"><code><a href="#environment"
                                                                                class="member-name-link">environment</a></code>
                                </div>
                                <div class="col-last even-row-color">
                                    <div class="block">Spring 环境对象</div>
                                </div>
                            </div>
                        </section>
                    </li>
                    <!-- ======== CONSTRUCTOR SUMMARY ======== -->
                    <li>
                        <section class="constructor-summary" id="constructor-summary">
                            <h2>构造器概要</h2>
                            <div class="caption"><span>构造器</span></div>
                            <div class="summary-table two-column-summary">
                                <div class="table-header col-first">构造器</div>
                                <div class="table-header col-last">说明</div>
                                <div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()"
                                                                                          class="member-name-link">LogAnnotationMergeStrategy</a>()</code>
                                </div>
                                <div class="col-last even-row-color">&nbsp;</div>
                            </div>
                        </section>
                    </li>
                    <!-- ========== METHOD SUMMARY =========== -->
                    <li>
                        <section class="method-summary" id="method-summary">
                            <h2>方法概要</h2>
                            <div id="method-summary-table">
                                <div class="table-tabs" role="tablist" aria-orientation="horizontal">
                                    <button id="method-summary-table-tab0" role="tab" aria-selected="true"
                                            aria-controls="method-summary-table.tabpanel" tabindex="0"
                                            onkeydown="switchTab(event)"
                                            onclick="show('method-summary-table', 'method-summary-table', 3)"
                                            class="active-table-tab">所有方法
                                    </button>
                                    <button id="method-summary-table-tab2" role="tab" aria-selected="false"
                                            aria-controls="method-summary-table.tabpanel" tabindex="-1"
                                            onkeydown="switchTab(event)"
                                            onclick="show('method-summary-table', 'method-summary-table-tab2', 3)"
                                            class="table-tab">实例方法
                                    </button>
                                    <button id="method-summary-table-tab4" role="tab" aria-selected="false"
                                            aria-controls="method-summary-table.tabpanel" tabindex="-1"
                                            onkeydown="switchTab(event)"
                                            onclick="show('method-summary-table', 'method-summary-table-tab4', 3)"
                                            class="table-tab">具体方法
                                    </button>
                                </div>
                                <div id="method-summary-table.tabpanel" role="tabpanel"
                                     aria-labelledby="method-summary-table-tab0">
                                    <div class="summary-table three-column-summary">
                                        <div class="table-header col-first">修饰符和类型</div>
                                        <div class="table-header col-second">方法</div>
                                        <div class="table-header col-last">说明</div>
                                        <div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
                                            <code><a
                                                    href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html"
                                                    title="java.lang中的类或接口"
                                                    class="external-link">String</a></code></div>
                                        <div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
                                            <code><a href="#getType()" class="member-name-link">getType</a>()</code>
                                        </div>
                                        <div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
                                            <div class="block">获取策略类型</div>
                                        </div>
                                        <div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
                                            <code><a href="../../annotation/LogAction.html"
                                                     title="annotation interface in com.zmbdp.common.log.annotation">LogAction</a></code>
                                        </div>
                                        <div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
                                            <code><a
                                                    href="#merge(com.zmbdp.common.log.annotation.LogAction,com.zmbdp.common.log.annotation.LogAction)"
                                                    class="member-name-link">merge</a>
                                                <wbr>
                                                (<a href="../../annotation/LogAction.html"
                                                    title="annotation interface in com.zmbdp.common.log.annotation">LogAction</a>&nbsp;methodLogAction,
                                                <a href="../../annotation/LogAction.html"
                                                   title="annotation interface in com.zmbdp.common.log.annotation">LogAction</a>&nbsp;classLogAction)</code>
                                        </div>
                                        <div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
                                            <div class="block">合并方法注解、类注解和全局配置</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="inherited-list">
                                <h3 id="methods-inherited-from-class-java.lang.Object">从类继承的方法&nbsp;java.lang.<a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html"
                                        title="java.lang中的类或接口" class="external-link">Object</a></h3>
                                <code><a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()"
                                        title="java.lang中的类或接口" class="external-link">clone</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)"
                                        title="java.lang中的类或接口" class="external-link">equals</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()"
                                        title="java.lang中的类或接口" class="external-link">finalize</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()"
                                        title="java.lang中的类或接口" class="external-link">getClass</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()"
                                        title="java.lang中的类或接口" class="external-link">hashCode</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()"
                                        title="java.lang中的类或接口" class="external-link">notify</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()"
                                        title="java.lang中的类或接口" class="external-link">notifyAll</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()"
                                        title="java.lang中的类或接口" class="external-link">toString</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()"
                                        title="java.lang中的类或接口" class="external-link">wait</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)"
                                        title="java.lang中的类或接口" class="external-link">wait</a>, <a
                                        href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)"
                                        title="java.lang中的类或接口" class="external-link">wait</a></code></div>
                        </section>
                    </li>
                </ul>
            </section>
            <section class="details">
                <ul class="details-list">
                    <!-- ============ FIELD DETAIL =========== -->
                    <li>
                        <section class="field-details" id="field-detail">
                            <h2>字段详细资料</h2>
                            <ul class="member-list">
                                <li>
                                    <section class="detail" id="environment">
                                        <h3>environment</h3>
                                        <div class="member-signature"><span class="annotations">@Autowired
</span><span class="modifiers">private</span>&nbsp;<span
                                                class="return-type">org.springframework.core.env.Environment</span>&nbsp;<span
                                                class="element-name">environment</span></div>
                                        <div class="block">Spring 环境对象
                                            <p>
                                                用于从配置中心（Nacos）读取全局默认配置。</div>
                                    </section>
                                </li>
                            </ul>
                        </section>
                    </li>
                    <!-- ========= CONSTRUCTOR DETAIL ======== -->
                    <li>
                        <section class="constructor-details" id="constructor-detail">
                            <h2>构造器详细资料</h2>
                            <ul class="member-list">
                                <li>
                                    <section class="detail" id="&lt;init&gt;()">
                                        <h3>LogAnnotationMergeStrategy</h3>
                                        <div class="member-signature"><span class="modifiers">public</span>&nbsp;<span
                                                class="element-name">LogAnnotationMergeStrategy</span>()
                                        </div>
                                    </section>
                                </li>
                            </ul>
                        </section>
                    </li>
                    <!-- ============ METHOD DETAIL ========== -->
                    <li>
                        <section class="method-details" id="method-detail">
                            <h2>方法详细资料</h2>
                            <ul class="member-list">
                                <li>
                                    <section class="detail" id="getType()">
                                        <h3>getType</h3>
                                        <div class="member-signature"><span class="modifiers">public</span>&nbsp;<span
                                                class="return-type"><a
                                                href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html"
                                                title="java.lang中的类或接口" class="external-link">String</a></span>&nbsp;<span
                                                class="element-name">getType</span>()
                                        </div>
                                        <div class="block"><span
                                                class="descfrm-type-label">从接口复制的说明:&nbsp;<code><a
                                                href="../ILogProcessStrategy.html#getType()">ILogProcessStrategy</a></code></span>
                                        </div>
                                        <div class="block">获取策略类型
                                            <p>
                                                返回当前策略的类型标识，用于区分不同的策略实现。
                                            <p>
                                                <b>策略类型：</b>
                                            <ul>
                                                <li>PARAM_EXTRACT：参数提取策略</li>
                                                <li>CONDITION_EVALUATE：条件评估策略</li>
                                                <li>DTO_BUILD：DTO 构建策略</li>
                                                <li>ANNOTATION_MERGE：注解合并策略</li>
                                            </ul>
                                        </div>
                                        <dl class="notes">
                                            <dt>指定者:</dt>
                                            <dd><code><a href="../ILogProcessStrategy.html#getType()">getType</a></code>&nbsp;在接口中&nbsp;<code><a
                                                    href="../ILogProcessStrategy.html"
                                                    title="com.zmbdp.common.log.strategy中的接口">ILogProcessStrategy</a></code>
                                            </dd>
                                            <dt>返回:</dt>
                                            <dd>策略类型标识</dd>
                                        </dl>
                                    </section>
                                </li>
                                <li>
                                    <section class="detail"
                                             id="merge(com.zmbdp.common.log.annotation.LogAction,com.zmbdp.common.log.annotation.LogAction)">
                                        <h3>merge</h3>
                                        <div class="member-signature"><span class="modifiers">public</span>&nbsp;<span
                                                class="return-type"><a href="../../annotation/LogAction.html"
                                                                       title="annotation interface in com.zmbdp.common.log.annotation">LogAction</a></span>&nbsp;<span
                                                class="element-name">merge</span>
                                            <wbr>
                                            <span class="parameters">(<a href="../../annotation/LogAction.html"
                                                                         title="annotation interface in com.zmbdp.common.log.annotation">LogAction</a>&nbsp;methodLogAction,
 <a href="../../annotation/LogAction.html" title="annotation interface in com.zmbdp.common.log.annotation">LogAction</a>&nbsp;classLogAction)</span>
                                        </div>
                                        <div class="block">合并方法注解、类注解和全局配置
                                            <p>
                                                按优先级合并方法注解、类注解和 Nacos 全局配置，返回动态代理对象。<br>
                                                优先级：方法注解 > 类注解 > Nacos 全局配置 > 默认值。
                                            <p>
                                                <b>执行流程：</b>
                                            <ol>
                                                <li>创建 LogAction 动态代理对象</li>
                                                <li>实现 annotationType() 方法返回 LogAction.class</li>
                                                <li>实现各个配置方法，按优先级返回配置值</li>
                                                <li>返回代理对象</li>
                                            </ol>
                                            <p>
                                                <b>使用示例：</b>
                                            <pre><code>
 // 方法注解
 @LogAction(value = "用户登录", recordParams = true)
 public Result login(LoginDTO loginDTO) { ... }

 // 类注解
 @LogAction(module = "用户模块", recordResult = true)
 public class UserService { ... }

 // 合并注解
 LogAction mergedAction = annotationMergeStrategy.merge(methodLogAction, classLogAction);
 // mergedAction.value() = "用户登录"（方法注解）
 // mergedAction.module() = "用户模块"（类注解）
 // mergedAction.recordParams() = true（方法注解）
 // mergedAction.recordResult() = true（类注解）
 </code></pre>
                                            <p>
                                                <b>注意事项：</b>
                                            <ul>
                                                <li>如果 methodLogAction 为 null，可能抛出 NullPointerException</li>
                                                <li>classLogAction 可以为 null，表示没有类注解</li>
                                                <li>返回的是动态代理对象，不是真实的注解对象</li>
                                                <li>配置值按需计算，支持动态更新</li>
                                            </ul>
                                        </div>
                                        <dl class="notes">
                                            <dt>参数:</dt>
                                            <dd><code>methodLogAction</code> - 方法注解（必不为 null）</dd>
                                            <dd><code>classLogAction</code> - 类注解（可为 null）</dd>
                                            <dt>返回:</dt>
                                            <dd>合并后的注解代理对象</dd>
                                            <dt>另请参阅:</dt>
                                            <dd>
                                                <ul class="see-list">
                                                    <li><a href="../../annotation/LogAction.html"
                                                           title="annotation interface in com.zmbdp.common.log.annotation"><code>LogAction</code></a>
                                                    </li>
                                                </ul>
                                            </dd>
                                        </dl>
                                    </section>
                                </li>
                            </ul>
                        </section>
                    </li>
                </ul>
            </section>
            <!-- ========= END OF CLASS DATA ========= -->
        </main>
    </div>
</div>
</body>
</html>
